{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar react_1 = require(\"react\");\nvar typeDefs_1 = require(\"./typeDefs\");\nvar useInjectScript_1 = __importDefault(require(\"./useInjectScript\"));\nfunction useDrivePicker() {\n  var defaultScopes = ['https://www.googleapis.com/auth/drive.readonly'];\n  var _a = (0, useInjectScript_1.default)('https://apis.google.com/js/api.js'),\n    loaded = _a[0],\n    error = _a[1];\n  var _b = (0, useInjectScript_1.default)('https://accounts.google.com/gsi/client'),\n    loadedGsi = _b[0],\n    errorGsi = _b[1];\n  var _c = (0, react_1.useState)(false),\n    pickerApiLoaded = _c[0],\n    setpickerApiLoaded = _c[1];\n  var _d = (0, react_1.useState)(false),\n    openAfterAuth = _d[0],\n    setOpenAfterAuth = _d[1];\n  var _e = (0, react_1.useState)(false),\n    authWindowVisible = _e[0],\n    setAuthWindowVisible = _e[1];\n  var _f = (0, react_1.useState)(typeDefs_1.defaultConfiguration),\n    config = _f[0],\n    setConfig = _f[1];\n  var _g = (0, react_1.useState)(),\n    authRes = _g[0],\n    setAuthRes = _g[1];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  var picker;\n  // get the apis from googleapis\n  (0, react_1.useEffect)(function () {\n    if (loaded && !error && loadedGsi && !errorGsi && !pickerApiLoaded) {\n      loadApis();\n    }\n  }, [loaded, error, loadedGsi, errorGsi, pickerApiLoaded]);\n  // use effect to open picker after auth\n  (0, react_1.useEffect)(function () {\n    if (openAfterAuth && config.token && loaded && !error && loadedGsi && !errorGsi && pickerApiLoaded) {\n      createPicker(config);\n      setOpenAfterAuth(false);\n    }\n  }, [openAfterAuth, config.token, loaded, error, loadedGsi, errorGsi, pickerApiLoaded]);\n  // open the picker\n  var openPicker = function (config) {\n    // global scope given conf\n    setConfig(config);\n    // if we didnt get token generate token.\n    if (!config.token) {\n      var client = google.accounts.oauth2.initTokenClient({\n        client_id: config.clientId,\n        scope: (config.customScopes ? __spreadArray(__spreadArray([], defaultScopes, true), config.customScopes, true) : defaultScopes).join(' '),\n        callback: function (tokenResponse) {\n          setAuthRes(tokenResponse);\n          createPicker(__assign(__assign({}, config), {\n            token: tokenResponse.access_token\n          }));\n        }\n      });\n      client.requestAccessToken();\n    }\n    // if we have token and everything is loaded open the picker\n    if (config.token && loaded && !error && pickerApiLoaded) {\n      return createPicker(config);\n    }\n  };\n  // load the Drive picker api\n  var loadApis = function () {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    window.gapi.load('auth');\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    window.gapi.load('picker', {\n      callback: onPickerApiLoad\n    });\n  };\n  var onPickerApiLoad = function () {\n    setpickerApiLoaded(true);\n  };\n  var createPicker = function (_a) {\n    var token = _a.token,\n      _b = _a.appId,\n      appId = _b === void 0 ? '' : _b,\n      _c = _a.supportDrives,\n      supportDrives = _c === void 0 ? false : _c,\n      developerKey = _a.developerKey,\n      _d = _a.viewId,\n      viewId = _d === void 0 ? 'DOCS' : _d,\n      disabled = _a.disabled,\n      multiselect = _a.multiselect,\n      setOrigin = _a.setOrigin,\n      _e = _a.showUploadView,\n      showUploadView = _e === void 0 ? false : _e,\n      showUploadFolders = _a.showUploadFolders,\n      _f = _a.setParentFolder,\n      setParentFolder = _f === void 0 ? '' : _f,\n      viewMimeTypes = _a.viewMimeTypes,\n      customViews = _a.customViews,\n      _g = _a.locale,\n      locale = _g === void 0 ? 'en' : _g,\n      setIncludeFolders = _a.setIncludeFolders,\n      setSelectFolderEnabled = _a.setSelectFolderEnabled,\n      _h = _a.disableDefaultView,\n      disableDefaultView = _h === void 0 ? false : _h,\n      callbackFunction = _a.callbackFunction;\n    if (disabled) return false;\n    var view = new google.picker.DocsView(google.picker.ViewId[viewId]);\n    if (viewMimeTypes) view.setMimeTypes(viewMimeTypes);\n    if (setIncludeFolders) view.setIncludeFolders(true);\n    if (setSelectFolderEnabled) view.setSelectFolderEnabled(true);\n    var uploadView = new google.picker.DocsUploadView();\n    if (viewMimeTypes) uploadView.setMimeTypes(viewMimeTypes);\n    if (showUploadFolders) uploadView.setIncludeFolders(true);\n    if (setParentFolder) uploadView.setParent(setParentFolder);\n    if (setParentFolder) view.setParent(setParentFolder);\n    picker = new google.picker.PickerBuilder().setAppId(appId).setOAuthToken(token).setDeveloperKey(developerKey).setLocale(locale).setCallback(callbackFunction);\n    if (setOrigin) {\n      picker.setOrigin(setOrigin);\n    }\n    if (!disableDefaultView) {\n      picker.addView(view);\n    }\n    if (customViews) {\n      customViews.map(function (view) {\n        return picker.addView(view);\n      });\n    }\n    if (multiselect) {\n      picker.enableFeature(google.picker.Feature.MULTISELECT_ENABLED);\n    }\n    if (showUploadView) picker.addView(uploadView);\n    if (supportDrives) {\n      picker.enableFeature(google.picker.Feature.SUPPORT_DRIVES);\n    }\n    picker.build().setVisible(true);\n    return true;\n  };\n  return [openPicker, authRes];\n}\nexports.default = useDrivePicker;","map":{"version":3,"names":["react_1","require","typeDefs_1","useInjectScript_1","__importDefault","useDrivePicker","defaultScopes","_a","default","loaded","error","_b","loadedGsi","errorGsi","_c","useState","pickerApiLoaded","setpickerApiLoaded","_d","openAfterAuth","setOpenAfterAuth","_e","authWindowVisible","setAuthWindowVisible","_f","defaultConfiguration","config","setConfig","_g","authRes","setAuthRes","picker","useEffect","loadApis","token","createPicker","openPicker","client","google","accounts","oauth2","initTokenClient","client_id","clientId","scope","customScopes","__spreadArray","join","callback","tokenResponse","__assign","access_token","requestAccessToken","window","gapi","load","onPickerApiLoad","appId","supportDrives","developerKey","viewId","disabled","multiselect","setOrigin","showUploadView","showUploadFolders","setParentFolder","viewMimeTypes","customViews","locale","setIncludeFolders","setSelectFolderEnabled","_h","disableDefaultView","callbackFunction","view","DocsView","ViewId","setMimeTypes","uploadView","DocsUploadView","setParent","PickerBuilder","setAppId","setOAuthToken","setDeveloperKey","setLocale","setCallback","addView","map","enableFeature","Feature","MULTISELECT_ENABLED","SUPPORT_DRIVES","build","setVisible","exports"],"sources":["../src/index.tsx"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}