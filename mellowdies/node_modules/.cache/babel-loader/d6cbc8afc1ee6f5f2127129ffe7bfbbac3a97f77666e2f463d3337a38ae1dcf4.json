{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar react_1 = require(\"react\");\nvar injectorState = {\n  queue: {},\n  injectorMap: {},\n  scriptMap: {}\n};\nfunction useInjectScript(url) {\n  var _a = (0, react_1.useState)({\n      loaded: false,\n      error: false\n    }),\n    state = _a[0],\n    setState = _a[1];\n  (0, react_1.useEffect)(function () {\n    var _a, _b, _c, _d, _e;\n    if (!((_a = injectorState.injectorMap) === null || _a === void 0 ? void 0 : _a[url])) {\n      injectorState.injectorMap[url] = 'init';\n    }\n    // check if the script is already cached\n    if (injectorState.injectorMap[url] === 'loaded') {\n      setState({\n        loaded: true,\n        error: false\n      });\n      return;\n    }\n    // check if the script already errored\n    if (injectorState.injectorMap[url] === 'error') {\n      setState({\n        loaded: true,\n        error: true\n      });\n      return;\n    }\n    var onScriptEvent = function (error) {\n      var _a, _b, _c, _d;\n      // Get all error or load functions and call them\n      if (error) console.log('error loading the script');\n      (_b = (_a = injectorState.queue) === null || _a === void 0 ? void 0 : _a[url]) === null || _b === void 0 ? void 0 : _b.forEach(function (job) {\n        return job(error);\n      });\n      if (error && injectorState.scriptMap[url]) {\n        (_d = (_c = injectorState.scriptMap) === null || _c === void 0 ? void 0 : _c[url]) === null || _d === void 0 ? void 0 : _d.remove();\n        injectorState.injectorMap[url] = 'error';\n      } else injectorState.injectorMap[url] = 'loaded';\n      delete injectorState.scriptMap[url];\n    };\n    var stateUpdate = function (error) {\n      setState({\n        loaded: true,\n        error: error\n      });\n    };\n    if (!((_b = injectorState.scriptMap) === null || _b === void 0 ? void 0 : _b[url])) {\n      injectorState.scriptMap[url] = document.createElement('script');\n      if (injectorState.scriptMap[url]) {\n        injectorState.scriptMap[url].src = url;\n        injectorState.scriptMap[url].async = true;\n        // append the script to the body\n        document.body.append(injectorState.scriptMap[url]);\n        injectorState.scriptMap[url].addEventListener('load', function () {\n          return onScriptEvent(false);\n        });\n        injectorState.scriptMap[url].addEventListener('error', function () {\n          return onScriptEvent(true);\n        });\n        injectorState.injectorMap[url] = 'loading';\n      }\n    }\n    if (!((_c = injectorState.queue) === null || _c === void 0 ? void 0 : _c[url])) {\n      injectorState.queue[url] = [stateUpdate];\n    } else {\n      (_e = (_d = injectorState.queue) === null || _d === void 0 ? void 0 : _d[url]) === null || _e === void 0 ? void 0 : _e.push(stateUpdate);\n    }\n    // remove the event listeners\n    return function () {\n      var _a, _b;\n      //checks the main injector instance\n      //prevents Cannot read property 'removeEventListener' of null in hot reload\n      if (!injectorState.scriptMap[url]) return;\n      (_a = injectorState.scriptMap[url]) === null || _a === void 0 ? void 0 : _a.removeEventListener('load', function () {\n        return onScriptEvent(true);\n      });\n      (_b = injectorState.scriptMap[url]) === null || _b === void 0 ? void 0 : _b.removeEventListener('error', function () {\n        return onScriptEvent(true);\n      });\n    };\n  }, [url]);\n  return [state.loaded, state.error];\n}\nexports.default = useInjectScript;","map":{"version":3,"names":["react_1","require","injectorState","queue","injectorMap","scriptMap","useInjectScript","url","_a","useState","loaded","error","state","setState","useEffect","onScriptEvent","console","log","_b","forEach","job","_d","_c","remove","stateUpdate","document","createElement","src","async","body","append","addEventListener","_e","push","removeEventListener","exports","default"],"sources":["../src/useInjectScript.tsx"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}